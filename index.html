<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Power Apps Launcher</title>
<style>
  body {
    margin: 0;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    background: #f4f4f4;
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100vh;
  }

  .container {
    text-align: center;
    background: white;
    padding: 40px 24px;
    border-radius: 16px;
    width: 92%;
    max-width: 420px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.08);
  }

  .logo {
    width: 120px;
    margin: 10px auto 20px;
  }

  h2 {
    margin: 8px 0;
    font-weight: 600;
  }

  p {
    color: #666;
    font-size: 14px;
    margin-bottom: 24px;
  }

  .primary-btn {
    background: #0078d4;
    color: white;
    border: none;
    padding: 12px 16px;
    width: 100%;
    border-radius: 8px;
    font-size: 15px;
    cursor: pointer;
  }

  .secondary-btn {
    margin-top: 12px;
    background: none;
    border: none;
    color: #0078d4;
    font-size: 14px;
    cursor: pointer;
  }

  .primary-btn:active {
    transform: scale(0.98);
  }
</style>
</head>

<body>

<div class="container">
  <!-- Replace with your Power Apps logo image -->
  <img class="logo" src="powerapps-logo.png" alt="Power Apps" />

  <h2>Power Apps</h2>
  <p>
    To get the best experience and full set of capabilities on your device,
    use the Power Apps app.
  </p>

  <button class="primary-btn" onclick="openApp()">Open the app</button>
  <button class="secondary-btn" onclick="continueBrowser()">Continue in browser</button>
</div>

<script>
const appScheme = "ms-apps://cordlifesg-validation.crm5.dynamics.com_d9f42236-18bd-4051-9532-3e2fdb8eed40?appLogicalName=cgl_CordlifeCRM&environmentId=3659aeb9-1b18-e0d1-8f4c-7eff79461995&restartApp=true&isShortcut=true&appType=AppModule&openApp=true&restartApp=true&forceOfflineDataSync=true&tenantId=ae576e0e-ec54-4eb6-8cc0-d72c34dec8f9&source=record&entityName=lead&recordId=52bcb82a-0079-49ff-b4a6-4524c627d96c";
const browserUrl = "https://contoso.crm5.dynamics.com/main.aspx?appid=d9f42236-18bd-4051-9532-3e2fdb8eed40&pagetype=entityrecord&etn=lead&id=408574d2-fe7f-4955-bc84-27a0e7a267fe";
const androidStore = "https://play.google.com/store/apps/details?id=com.microsoft.msapps&hl=en";
const iosStore = "https://apps.apple.com/us/app/power-apps/id1047318566";

function detectOS() {
  const ua = navigator.userAgent || navigator.vendor || window.opera;

  if (/android/i.test(ua)) return "android";
  if (/iPad|iPhone|iPod/.test(ua) && !window.MSStream) return "ios";
  return "other";
}

function openApp() {
  const os = detectOS();
  const start = Date.now();

  // Try to open app
  window.location = appScheme;

  // Fallback after delay
  setTimeout(() => {
    const elapsed = Date.now() - start;

    // If app didnâ€™t open, redirect to store
    if (elapsed < 2000) {
      if (os === "android") window.location = androidStore;
      else if (os === "ios") window.location = iosStore;
    }
  }, 1500);
}

function continueBrowser() {
  window.location = browserUrl;
}
</script>

</body>

</html>
